"use strict";(self.webpackChunkreact_mind_map=self.webpackChunkreact_mind_map||[]).push([[212],{4440:(e,r,s)=>{s.d(r,{Jp:()=>i,Zm:()=>n,kz:()=>a,or:()=>c,z8:()=>o});var t=s(6629);const n=e=>(0,t.$E)("/user/doLogin",{...e}),a=e=>(0,t.$E)("/user/register",{...e}),o=e=>(0,t.x4)("/user/getCaptcha",{...e}),c=e=>(0,t.$E)("/file/upload",e),i=e=>(0,t.x4)("/file/getFile",e)},6629:(e,r,s)=>{s.d(r,{$E:()=>l,ZF:()=>o,bj:()=>c,oJ:()=>a,x4:()=>d});var t=s(3057),n=s(6213);const a=e=>["200",200].includes(e),o=e=>["100005",100005].includes(e),c="",i=n.A.create({baseURL:"http://47.121.126.205:8099/file-api/v1",timeout:7e3,headers:{"Content-Type":"application/json;charset=utf-8"},withCredentials:!1});i.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),i.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject({code:e.response.data.status,data:e.response.data.error||"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"})}));const l=(e,r)=>new Promise(((s,n)=>{const{getToken:a}=(0,t.Nv)(),o=a(),c={url:e,method:"post",data:Object.assign({...r}),headers:{token:o}};i.request(c).then((e=>{s(e.data)})).catch((e=>{n(e.message)}))})),d=(e,r)=>new Promise(((s,n)=>{const{getToken:a}=(0,t.Nv)(),o=a(),c={url:e,method:"get",params:r,headers:{token:o}};i.request(c).then((e=>{s(e.data)})).catch((e=>{n(e.message)}))}))},7289:(e,r,s)=>{s.d(r,{z:()=>n});var t=s(906);function n(){const e=(0,t.zy)(),r=new URLSearchParams(e.search),s={};return r.forEach(((e,r)=>{s[r]=e})),s}},3845:(e,r,s)=>{s.r(r),s.d(r,{default:()=>F});var t=s(9692),n=s(7110);const a=s(8821).A;var o=s(7144);const c=s(227).A;var i=s(7342),l=s(8499),d=s(4775),m=s(7893),u=s(5043);const h="index_loginWarp__Fq-J-",p="index_innerWarp__VGWN4";var x=s(3722),f=s(9379);const A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M516 673c0 4.4 3.4 8 7.5 8h185c4.1 0 7.5-3.6 7.5-8v-48c0-4.4-3.4-8-7.5-8h-185c-4.1 0-7.5 3.6-7.5 8v48zm-194.9 6.1l192-161c3.8-3.2 3.8-9.1 0-12.3l-192-160.9A7.95 7.95 0 00308 351v62.7c0 2.4 1 4.6 2.9 6.1L420.7 512l-109.8 92.2a8.1 8.1 0 00-2.9 6.1V673c0 6.8 7.9 10.5 13.1 6.1zM880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"code",theme:"outlined"};var j=s(2248),v=function(e,r){return u.createElement(j.A,(0,f.A)((0,f.A)({},e),{},{ref:r,icon:A}))};const g=u.forwardRef(v);var w=s(8617),y=s(906),k=s(4440),z=s(6629),b=s(4612),E=s(3057),_=s(7289),q=s(579);const L=()=>{const e=(0,y.Zp)(),r=(0,_.z)(),[s]=m.A.useForm(),{setUserName:f}=(0,E.Mm)(),{setToken:A}=(0,E.Nv)(),[j,v]=(0,u.useState)(!0),[L,F]=(0,u.useState)(void 0),$=(0,u.useRef)(null);(0,u.useEffect)((()=>{if(void 0!==L){if(L>0)$.current=setTimeout((()=>{F(L-1)}),1e3);else{const[e]=s.getFieldsError(["username"]);!e.errors.length&&v(!1)}return()=>{$.current&&clearTimeout($.current)}}}),[L]);const[C,N]=(0,u.useState)([]),I=(e,r,t)=>{const n=s.getFieldsValue(!0);r?r.length<6?t(new Error("\u8bf7\u8f93\u5165\u8d85\u8fc76\u4f4d\u7684\u5bc6\u7801")):n.password===n.repassword?(s.setFields([{name:"repassword",errors:null}]),s.setFields([{name:"password",errors:null}]),t()):t(new Error("\u8bf7\u786e\u4fdd\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e00\u6837")):t(new Error("\u8bf7\u8f93\u5165\u5bc6\u7801"))};return(0,q.jsx)("div",{className:h,children:(0,q.jsx)("div",{className:p,children:(0,q.jsxs)(m.A,{form:s,name:"login",initialValues:{remember:!0},onFinish:async s=>{const t=await(0,k.kz)({username:s.username,password:s.password,captcha:s.emailCode,isLogin:!0});(0,z.oJ)(t.code)?(f(s.username),A(t.data.token),d.Ay.success({content:"\u6ce8\u518c\u6210\u529f\uff0c\u5373\u5c06\u81ea\u52a8\u767b\u9646\u5e76\u8df3\u8f6c\u8bbf\u95ee\u9875\u9762"}),setTimeout((()=>{null!==r&&void 0!==r&&r.from&&(window.location.href=r.from),e("/")}),3e3)):d.Ay.error({content:t.data||"\u6ce8\u518c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"})},children:[(0,q.jsx)(m.A.Item,{name:"username",rules:[{required:!0,validator:(e,r,s)=>{/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(r)?(s(),!L&&v(!1)):(s(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1")),v(!0))}}],children:(0,q.jsx)(l.A,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u7528\u6237\u540d",prefix:(0,q.jsx)(x.A,{}),onSearch:e=>{N((()=>!e||e.includes("@")?[]:b.MY.map((r=>({label:`${e}@${r}`,value:`${e}@${r}`})))))},options:C})}),(0,q.jsx)(m.A.Item,{name:"emailCode",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u9a8c\u8bc1\u7801"}],children:(0,q.jsxs)(a,{gutter:8,wrap:!1,children:[(0,q.jsx)(c,{flex:2,children:(0,q.jsx)(i.A,{minLength:6,maxLength:6,prefix:(0,q.jsx)(g,{}),type:"text",placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u9a8c\u8bc1\u7801"})}),(0,q.jsx)(c,{flex:1,children:(0,q.jsx)(o.Ay,{onClick:async()=>{if(!j){const e=s.getFieldsValue(!0);let r=await(0,k.z8)({account:e.username});(0,z.oJ)(r.code)?(d.Ay.success({content:"\u53d1\u9001\u6210\u529f\uff0c\u8bf7\u524d\u5f80\u90ae\u7bb1\u67e5\u770b"}),v(!0),F(300)):d.Ay.error({content:r.data||"\u7f51\u7edc\u95ee\u9898\uff0c\u8bf7\u91cd\u65b0\u53d1\u9001"})}},disabled:j,children:L?`${L}\u79d2\u540e\u91cd\u65b0\u53d1\u9001`:"\u53d1\u9001\u9a8c\u8bc1\u7801"})})]})}),(0,q.jsx)(m.A.Item,{name:"password",rules:[{required:!0,validator:I}],children:(0,q.jsx)(i.A.Password,{minLength:6,prefix:(0,q.jsx)(w.A,{}),type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"})}),(0,q.jsx)(m.A.Item,{name:"repassword",rules:[{required:!0,validator:I}],children:(0,q.jsx)(i.A.Password,{minLength:6,prefix:(0,q.jsx)(w.A,{}),type:"password",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801"})}),(0,q.jsx)(m.A.Item,{name:"inventCode",rules:[{required:!0,validator:(e,r,s)=>{r===b.KO?s():s(new Error("\u8bf7\u8054\u7cfb\u9080\u8bf7\u4eba\u7d22\u53d6\u9080\u8bf7\u7801"))}}],children:(0,q.jsx)(i.A,{minLength:6,prefix:(0,q.jsx)(w.A,{}),type:"text",placeholder:"\u9080\u8bf7\u7801\u627e\u63a8\u8350\u4f60\u7684\u4eba\u7d22\u53d6"})}),(0,q.jsx)(m.A.Item,{children:(0,q.jsx)(t.A,{justify:"space-between",align:"center",children:(0,q.jsx)(m.A.Item,{name:"remember",valuePropName:"checked",noStyle:!0,children:(0,q.jsx)(n.A,{children:"\u8bb0\u4f4f\u72b6\u6001"})})})}),(0,q.jsxs)(m.A.Item,{children:[(0,q.jsx)(o.Ay,{block:!0,type:"primary",htmlType:"submit",children:"\u6ce8\u518c&\u767b\u5f55"}),"\u6216",(0,q.jsx)(y.N_,{to:{pathname:"/login"},children:"\u53bb\u767b\u5f55"})]})]})})})},F=(0,u.memo)(L)},4612:(e,r,s)=>{s.d(r,{KO:()=>n,LY:()=>a,MY:()=>t});const t=["qq.com","163.com","@sina.com","@aliyun.com","@16com","@18com","@hotmail.com","@sohu.com","@mail.com","gmail.com"],n="666888",a=2}}]);
//# sourceMappingURL=regiest.ef2f6c4a.chunk.js.map